<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birthday Gift for Avril</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f8ff;
            color: #333;
            text-align: center;
            overflow-x: hidden;
        }
        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 20px;
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            cursor: pointer;
            border-radius: 5px;
            margin: 10px;
        }
        button:hover {
            background-color: #45a049;
        }
        .hidden {
            display: none;
        }
        .tulips {
            position: relative;
            height: 400px;
            background: linear-gradient(to bottom, #87CEEB, #228B22);
            overflow: hidden;
        }
        .grass {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 100px;
            background-color: #228B22;
        }
        .tulip {
            position: absolute;
            bottom: 100px;
            width: 50px;
            height: 100px;
            background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iMTAwIiB2aWV3Qm94PSIwIDAgNTAgMTAwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMTUgMTAwVjUwYzAtMTMuMyAxMC44LTI0IDI0LTI0czI0IDEwLjcgMjQgMjR2NTBaIiBmaWxsPSIjMDAwMEZGIi8+CjxjaXJjbGUgY3g9IjI1IiBjeT0iMzAiIHI9IjEwIiBmaWxsPSIjMDAwMEZGIi8+Cjwvc3ZnPg==') no-repeat center;
            animation: sway 3s ease-in-out infinite;
        }
        .tulip:nth-child(odd) { animation-delay: 0.5s; }
        .tulip:nth-child(even) { animation-delay: 1s; }
        @keyframes sway {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(5deg); }
        }
        .cake {
            width: 300px;
            height: 200px;
            background-color: #D2691E;
            border-radius: 10px;
            position: relative;
            margin: 20px auto;
            border: 2px solid #8B4513;
        }
        .candle {
            width: 20px;
            height: 40px;
            background-color: #FFFACD;
            position: absolute;
            cursor: grab;
            border-radius: 2px;
        }
        .candle.flame {
            background-color: #FFA500;
            height: 10px;
            top: -10px;
        }
        .envelope {
            width: 200px;
            height: 150px;
            background-color: #F5DEB3;
            border: 2px solid #8B4513;
            position: relative;
            margin: 20px auto;
            cursor: pointer;
        }
        .envelope::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 0;
            border-left: 100px solid transparent;
            border-right: 100px solid transparent;
            border-bottom: 75px solid #D2691E;
        }
        .letter {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #FFF;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
            max-width: 80%;
            animation: slideUp 1s ease-out;
        }
        @keyframes slideUp {
            from { transform: translate(-50%, 100%); }
            to { transform: translate(-50%, -50%); }
        }
        .minigame {
            padding: 20px;
        }
        .heart {
            font-size: 50px;
            color: red;
            cursor: pointer;
            display: inline-block;
            margin: 10px;
        }
        .collected {
            color: pink;
        }
        @media (max-width: 600px) {
            .cake { width: 250px; height: 150px; }
            .tulip { width: 40px; height: 80px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="intro">
            <h1>Are you ready for your birthday gift?</h1>
            <button onclick="start()">Yes</button>
            <button onclick="no()">No</button>
        </div>

        <div id="minigame" class="hidden">
            <h2>Minigame: Collect 11 Hearts for Our 11 Months!</h2>
            <p>Click on the hearts to collect them. Collect all 11 to proceed!</p>
            <div id="hearts">
                <span class="heart" onclick="collect(this)">‚ù§Ô∏è</span>
                <span class="heart" onclick="collect(this)">‚ù§Ô∏è</span>
                <span class="heart" onclick="collect(this)">‚ù§Ô∏è</span>
                <span class="heart" onclick="collect(this)">‚ù§Ô∏è</span>
                <span class="heart" onclick="collect(this)">‚ù§Ô∏è</span>
                <span class="heart" onclick="collect(this)">‚ù§Ô∏è</span>
                <span class="heart" onclick="collect(this)">‚ù§Ô∏è</span>
                <span class="heart" onclick="collect(this)">‚ù§Ô∏è</span>
                <span class="heart" onclick="collect(this)">‚ù§Ô∏è</span>
                <span class="heart" onclick="collect(this)">‚ù§Ô∏è</span>
                <span class="heart" onclick="collect(this)">‚ù§Ô∏è</span>
            </div>
            <p id="count">Hearts collected: 0/11</p>
        </div>

        <div id="tulips" class="hidden">
            <h2>17 Blue Tulips for You</h2>
            <div class="grass"></div>
            <div class="tulip" style="left: 10%;"></div>
            <div class="tulip" style="left: 20%;"></div>
            <div class="tulip" style="left: 30%;"></div>
            <div class="tulip" style="left: 40%;"></div>
            <div class="tulip" style="left: 50%;"></div>
            <div class="tulip" style="left: 60%;"></div>
            <div class="tulip" style="left: 70%;"></div>
            <div class="tulip" style="left: 80%;"></div>
            <div class="tulip" style="left: 90%;"></div>
            <div class="tulip" style="left: 15%;"></div>
            <div class="tulip" style="left: 25%;"></div>
            <div class="tulip" style="left: 35%;"></div>
            <div class="tulip" style="left: 45%;"></div>
            <div class="tulip" style="left: 55%;"></div>
            <div class="tulip" style="left: 65%;"></div>
            <div class="tulip" style="left: 75%;"></div>
            <div class="tulip" style="left: 85%;"></div>
        </div>

        <div id="cake-section" class="hidden">
            <h2>Your Birthday Cake</h2>
            <div class="cake" id="cake">
                <!-- Candles will be added here -->
            </div>
            <p>Drag the 17 candles to the cake, then blow them out by speaking into your microphone!</p>
            <button id="blow-btn" class="hidden" onclick="blowCandles()">Blow Candles</button>
        </div>

        <div id="letter-section" class="hidden">
            <h2>Your Letter</h2>
            <div class="envelope" onclick="openLetter()"></div>
            <div id="letter" class="hidden">
                <p>Dear Avril,</p>
                <p>[Your letter content here - you can edit this part]</p>
                <p>Love,</p>
                <p>Your Special Someone</p>
            </div>
        </div>

        <div id="outro" class="hidden">
            <h2>I hope you like it! I love you so much and happy birthday and 11th courtsary to us my avril, avi, avipotpot, bunso, master, baby, bebi, wifey, lovey, asawa ko, love of my life ko, mahal ko, love, darling, and my miss beautiful gorgeosarus ko üíô</h2>
        </div>
    </div>

    <script>
        let collectedHearts = 0;
        const totalHearts = 11;
        let candlesPlaced = 0;
        const totalCandles = 17;

        function start() {
            document.getElementById('intro').classList.add('hidden');
            document.getElementById('minigame').classList.remove('hidden');
        }

        function no() {
            alert("Please say yes! üòä");
        }

        function collect(heart) {
            if (!heart.classList.contains('collected')) {
                heart.classList.add('collected');
                collectedHearts++;
                document.getElementById('count').textContent = `Hearts collected: ${collectedHearts}/${totalHearts}`;
                if (collectedHearts === totalHearts) {
                    setTimeout(() => {
                        document.getElementById('minigame').classList.add('hidden');
                        document.getElementById('tulips').classList.remove('hidden');
                        setTimeout(() => {
                            document.getElementById('tulips').classList.add('hidden');
                            document.getElementById('cake-section').classList.remove('hidden');
                            createCandles();
                        }, 5000);
                    }, 1000);
                }
            }
        }

        function createCandles() {
            const cake = document.getElementById('cake');
            for (let i = 0; i < totalCandles; i++) {
                const candle = document.createElement('div');
                candle.className = 'candle';
                candle.style.left = `${Math.random() * 250}px`;
                candle.style.top = `${Math.random() * 150}px`;
                candle.draggable = true;
                candle.addEventListener('dragstart', dragStart);
                candle.addEventListener('dragend', dragEnd);
                document.body.appendChild(candle);
            }
        }

        function dragStart(e) {
            e.dataTransfer.setData('text/plain', e.target.id || 'candle');
        }

        function dragEnd(e) {
            const cake = document.getElementById('cake');
            const rect = cake.getBoundingClientRect();
            if (e.clientX >= rect.left && e.clientX <= rect.right && e.clientY >= rect.top && e.clientY <= rect.bottom) {
                e.target.style.left = `${rect.left + Math.random() * 250}px`;
                e.target.style.top = `${rect.top + Math.random() * 150}px`;
                e.target.classList.add('flame');
                candlesPlaced++;
                if (candlesPlaced === totalCandles) {
                    document.getElementById('blow-btn').classList.remove('hidden');
                }
            }
        }

        function blowCandles() {
            // Simple microphone blow detection using Web Audio API
            navigator.mediaDevices.getUserMedia({ audio: true })
                .then(stream => {
                    const audioContext = new AudioContext();
                    const analyser = audioContext.createAnalyser();
                    const microphone = audioContext.createMediaStreamSource(stream);
                    microphone.connect(analyser);
                    analyser.fftSize = 256;
                    const bufferLength = analyser.frequencyBinCount;
                    const dataArray = new Uint8Array(bufferLength);

                    function checkBlow() {
                        analyser.getByteFrequencyData(dataArray);
                        const average = dataArray.reduce((a, b) => a + b) / bufferLength;
                        if (average > 50) { // Threshold for blow detection
                            document.querySelectorAll('.candle.flame').forEach(candle => candle.remove());
                            audioContext.close();
                            stream.getTracks().forEach(track => track.stop());
                            setTimeout(() => {
                                document.getElementById('cake-section').classList.add('hidden');
                                document.getElementById('letter-section').classList.remove('hidden');
                            }, 2000);
                        } else {
                            requestAnimationFrame(checkBlow);
                        }
                    }
                    checkBlow();
                })
                .catch(err => {
                    alert('Microphone access denied. Please allow access to blow the candles.');
                });
        }

        function openLetter() {
            document.getElementById('letter').classList.remove('hidden');
            setTimeout(() => {
                document.getElementById('letter-section').classList.add('hidden');
                document.getElementById('outro').classList.remove('hidden');
            }, 5000);
        }
    </script>
</body>
</html>
