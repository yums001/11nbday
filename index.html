<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For My Avril - Happy Birthday & 11 Months!</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #e6f7ff, #b3e0ff);
            color: #333;
            overflow-x: hidden;
            min-height: 100vh;
            padding-bottom: 20px;
        }
        
        .decoration {
            position: fixed;
            z-index: -1;
            opacity: 0.3;
        }
        
        .decoration.circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background-color: #1a73e8;
            top: 10%;
            right: 5%;
        }
        
        .decoration.square {
            width: 100px;
            height: 100px;
            background-color: #4fc3f7;
            bottom: 15%;
            left: 5%;
            transform: rotate(45deg);
        }
        
        .decoration.heart {
            font-size: 80px;
            color: #1a73e8;
            top: 70%;
            right: 10%;
        }
        
        .section {
            min-height: 100vh;
            width: 100%;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            text-align: center;
            position: relative;
        }
        
        .active {
            display: flex;
        }
        
        h1, h2 {
            color: #1a73e8;
            margin-bottom: 20px;
        }
        
        h1 {
            font-size: 2.2rem;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
        }
        
        p {
            font-size: 1.2rem;
            line-height: 1.6;
            margin-bottom: 30px;
            max-width: 800px;
        }
        
        .btn {
            background-color: #1a73e8;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .btn:hover {
            background-color: #0d62d9;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-no {
            background-color: #ff4081;
        }
        
        .btn-no:hover {
            background-color: #e91e63;
        }
        
        /* Introduction Section */
        .heart {
            color: #ff4081;
            font-size: 4rem;
            margin: 20px 0;
            animation: heartbeat 1.5s infinite;
        }
        
        @keyframes heartbeat {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        /* Minigame Section */
        .game-container {
            background-color: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            width: 90%;
            max-width: 500px;
            margin-top: 20px;
        }
        
        .memory-game {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        
        .memory-card {
            height: 80px;
            background-color: #1a73e8;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            color: white;
            cursor: pointer;
            transform-style: preserve-3d;
            transition: transform 0.5s;
        }
        
        .memory-card.flipped {
            transform: rotateY(180deg);
            background-color: #ff4081;
        }
        
        .memory-card.matched {
            background-color: #4caf50;
            cursor: default;
        }
        
        .game-instructions {
            font-size: 1rem;
            margin-top: 20px;
            color: #666;
        }
        
        /* Tulips Section - IMPROVED */
        .tulip-field {
            width: 100%;
            height: 60vh;
            position: relative;
            margin-top: 20px;
            overflow: hidden;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .grass {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 40%;
            background: linear-gradient(to top, #2e7d32, #4caf50, #8bc34a);
        }
        
        .tulip {
            position: absolute;
            bottom: 40%;
            width: 50px;
            height: 140px;
            z-index: 2;
        }
        
        .tulip-stem {
            position: absolute;
            bottom: 0;
            left: 20px;
            width: 6px;
            height: 110px;
            background: linear-gradient(to right, #388e3c, #4caf50, #66bb6a);
        }
        
        .tulip-flower {
            position: absolute;
            bottom: 100px;
            left: 5px;
            width: 40px;
            height: 50px;
            background: linear-gradient(to bottom, #42a5f5, #1a73e8, #0d47a1);
            border-radius: 60% 60% 40% 40%;
            transform-origin: bottom center;
            animation: sway 4s ease-in-out infinite;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
        }
        
        .tulip-leaf {
            position: absolute;
            width: 25px;
            height: 40px;
            background-color: #4caf50;
            border-radius: 50%;
            z-index: 1;
        }
        
        .leaf-left {
            bottom: 50px;
            left: 5px;
            transform: rotate(30deg);
        }
        
        .leaf-right {
            bottom: 60px;
            left: 25px;
            transform: rotate(-20deg);
        }
        
        @keyframes sway {
            0%, 100% { transform: rotate(-3deg) translateX(-2px); }
            50% { transform: rotate(3deg) translateX(2px); }
        }
        
        /* Cake Section - IMPROVED */
        .cake-container {
            width: 90%;
            max-width: 600px;
            margin-top: 20px;
        }
        
        .cake {
            width: 350px;
            height: 150px;
            background: linear-gradient(to top, #3e2723, #5d4037, #795548);
            border-radius: 20px 20px 0 0;
            margin: 0 auto 40px;
            position: relative;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        
        .cake-top {
            width: 370px;
            height: 40px;
            background-color: #3e2723;
            border-radius: 50%;
            position: absolute;
            top: -20px;
            left: -10px;
            box-shadow: inset 0 5px 10px rgba(255,255,255,0.1);
        }
        
        .cake-decoration {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 20px 20px 0 0;
            overflow: hidden;
        }
        
        .cake-spot {
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: #ffccbc;
            border-radius: 50%;
        }
        
        .candle-area {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
            padding: 15px;
            background-color: rgba(255,255,255,0.8);
            border-radius: 15px;
        }
        
        .candle {
            width: 20px;
            height: 60px;
            background: linear-gradient(to bottom, #42a5f5, #1a73e8);
            border-radius: 3px;
            cursor: grab;
            position: relative;
            transition: transform 0.3s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .candle.placed {
            position: absolute;
            top: -75px;
            transform: scale(0.9);
        }
        
        .flame {
            width: 12px;
            height: 20px;
            background: radial-gradient(#ffeb3b, #ff9800, #ff5722);
            border-radius: 50% 50% 20% 20%;
            position: absolute;
            top: -25px;
            left: 4px;
            opacity: 0;
            box-shadow: 0 0 10px #ff9800;
        }
        
        .flame.lit {
            opacity: 1;
            animation: flicker 0.5s infinite alternate;
        }
        
        @keyframes flicker {
            0% { transform: scale(1); }
            100% { transform: scale(1.1) translateX(1px); }
        }
        
        .blow-instructions {
            margin-top: 20px;
            padding: 15px;
            background-color: rgba(26, 115, 232, 0.1);
            border-radius: 10px;
            font-size: 1rem;
        }
        
        .microphone-btn {
            font-size: 2rem;
            color: #1a73e8;
            background: white;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px auto;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }
        
        .microphone-btn.listening {
            animation: pulse 1s infinite;
            background-color: #ff4081;
            color: white;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        /* Letter Section - IMPROVED */
        .letter-container {
            width: 90%;
            max-width: 500px;
            margin-top: 20px;
            position: relative;
            height: 300px;
        }
        
        .envelope {
            width: 280px;
            height: 180px;
            background: linear-gradient(135deg, #42a5f5, #1a73e8);
            position: relative;
            margin: 0 auto;
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0 10px 25px rgba(26, 115, 232, 0.3);
            transition: transform 0.5s;
            z-index: 5;
        }
        
        .envelope:hover {
            transform: scale(1.05);
        }
        
        .envelope:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 48%, rgba(255,255,255,0.3) 50%, transparent 52%);
            border-radius: 10px;
        }
        
        .envelope-flap {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #42a5f5, #1a73e8);
            clip-path: polygon(0% 0%, 50% 50%, 100% 0%);
            border-radius: 10px 10px 0 0;
        }
        
        .letter-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }
        
        .letter-overlay.active {
            display: flex;
            animation: fadeIn 0.3s;
        }
        
        .letter {
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            background-color: #fff9e6;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
            text-align: left;
            position: relative;
            overflow-y: auto;
            animation: popUp 0.5s;
        }
        
        .letter-content {
            font-family: 'Georgia', serif;
            line-height: 1.8;
        }
        
        .letter-content h3 {
            text-align: center;
            margin-bottom: 20px;
            color: #1a73e8;
        }
        
        .letter-content p {
            margin-bottom: 15px;
            font-size: 1rem;
            text-align: justify;
        }
        
        @keyframes popUp {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        @keyframes fadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }
        
        .close-letter {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 2rem;
            color: #666;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .close-letter:hover {
            background-color: rgba(0,0,0,0.1);
        }
        
        /* Outro Section - IMPROVED */
        .outro-container {
            background-color: white;
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            max-width: 500px;
        }
        
        .blue-heart {
            color: #1a73e8;
            font-size: 3rem;
            margin: 20px 0;
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }
        
        /* Navigation */
        .nav-buttons {
            display: flex;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            background-color: rgba(255,255,255,0.8);
            border: 2px solid #1a73e8;
            color: #1a73e8;
            padding: 10px 15px;
            border-radius: 50px;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s;
        }
        
        .nav-btn:hover {
            background-color: #1a73e8;
            color: white;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            h1 {
                font-size: 1.8rem;
            }
            
            p {
                font-size: 1.1rem;
            }
            
            .memory-card {
                height: 70px;
            }
            
            .cake {
                width: 300px;
                height: 130px;
            }
            
            .cake-top {
                width: 320px;
            }
            
            .tulip {
                width: 40px;
                height: 120px;
            }
            
            .tulip-flower {
                width: 35px;
                height: 45px;
            }
        }
        
        @media (max-width: 480px) {
            h1 {
                font-size: 1.5rem;
            }
            
            .btn {
                padding: 12px 25px;
                font-size: 1rem;
            }
            
            .memory-game {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .memory-card {
                height: 60px;
                font-size: 1.5rem;
            }
            
            .cake {
                width: 250px;
                height: 110px;
            }
            
            .cake-top {
                width: 270px;
            }
            
            .envelope, .letter {
                width: 95%;
            }
            
            .tulip {
                width: 35px;
                height: 110px;
            }
        }
    </style>
</head>
<body>
    <!-- Background Decorations -->
    <div class="decoration circle"></div>
    <div class="decoration square"></div>
    <div class="decoration heart">üíô</div>
    
    <!-- Introduction Section -->
    <section id="intro" class="section active">
        <h1>For My Dearest Avril</h1>
        <div class="heart">‚ù§Ô∏è</div>
        <p>My love, today is a very special day - it's your birthday and our 11th month of being together! Are you ready for your gift?</p>
        <div>
            <button id="yes-btn" class="btn">Yes, my love! ‚ù§Ô∏è</button>
            <button id="no-btn" class="btn btn-no">No, not yet...</button>
        </div>
    </section>

    <!-- Minigame Section -->
    <section id="minigame" class="section">
        <h1>Memory Game - Our 11 Months Together</h1>
        <p>Let's play a quick game! Match the pairs to reveal special moments from our 11 months together.</p>
        
        <div class="game-container">
            <div class="memory-game" id="memory-game">
                <!-- Cards will be generated by JavaScript -->
            </div>
            
            <p class="game-instructions">Match all pairs to continue to your gift!</p>
            <button id="continue-btn" class="btn" disabled>Continue to Next Surprise</button>
        </div>
    </section>

    <!-- Tulips Section -->
    <section id="tulips" class="section">
        <h1>17 Blue Tulips for You</h1>
        <p>My love, I give you 17 blue tulips - each representing something special I love about you.</p>
        
        <div class="tulip-field">
            <div class="grass"></div>
            <!-- 17 tulips will be generated by JavaScript -->
        </div>
        
        <p style="margin-top: 20px;">Blue tulips symbolize tranquility, peace, and unique love - just like what we share.</p>
        <button id="next-cake" class="btn">Next Surprise</button>
    </section>

    <!-- Cake Section -->
    <section id="cake" class="section">
        <h1>Happy Birthday Cake!</h1>
        <p>My love, here's a birthday cake for you with 17 candles. Drag the candles to the cake and then blow them out!</p>
        
        <div class="cake-container">
            <div class="cake">
                <div class="cake-top"></div>
                <div class="cake-decoration" id="cake-decoration"></div>
                <div id="cake-candles"></div>
            </div>
            
            <div class="candle-area" id="candle-area">
                <!-- 17 candles will be generated by JavaScript -->
            </div>
            
            <div class="blow-instructions">
                <p>Place all 17 candles on the cake, then click the microphone and blow to extinguish the candles!</p>
                
                <div class="microphone-btn" id="microphone">
                    <i class="fas fa-microphone"></i>
                </div>
                
                <p id="mic-status">Drag the blue candles to the cake</p>
            </div>
        </div>
        
        <button id="next-letter" class="btn" disabled>Continue to Next Surprise</button>
    </section>

    <!-- Letter Section -->
    <section id="letter" class="section">
        <h1>A Letter for You</h1>
        <p>My love, tap the blue envelope to read a special letter just for you.</p>
        
        <div class="letter-container">
            <div class="envelope" id="envelope">
                <div class="envelope-flap"></div>
                <i class="fas fa-envelope-open-text" style="font-size: 3rem; color: white; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);"></i>
            </div>
        </div>
        
        <!-- Letter Overlay -->
        <div class="letter-overlay" id="letter-overlay">
            <div class="letter" id="letter-content">
                <button class="close-letter" id="close-letter">√ó</button>
                <div class="letter-content">
                    <h3>My Dearest Avril,</h3>
                    <p>Happy Birthday, my love! Today marks not only the celebration of your birth but also 11 wonderful months of us being together.</p>
                    <p>These past 11 months have been the most beautiful journey of my life. From the moment we started talking, I knew there was something special about you. Every day with you feels like a blessing, and I'm grateful for every smile, every laugh, and every moment we share.</p>
                    <p>You've brought so much joy, love, and light into my life. You're not just my girlfriend; you're my best friend, my confidante, my partner in crime, and my greatest supporter.</p>
                    <p>As we celebrate your birthday today, I want to remind you how incredibly special you are. You're beautiful inside and out, intelligent, kind, and have the most amazing heart. I'm so lucky to have you in my life.</p>
                    <p>Here's to many more birthdays together, my love. Here's to many more months and years of growing together, laughing together, and loving each other more each day.</p>
                    <p>Thank you for being you. Thank you for loving me. Thank you for everything.</p>
                    <p>With all my love, always and forever,</p>
                    <p style="text-align: right; margin-top: 30px;">Your loving partner<br>Who adores you more than words can express</p>
                </div>
            </div>
        </div>
        
        <button id="next-outro" class="btn">Continue to Final Surprise</button>
    </section>

    <!-- Outro Section -->
    <section id="outro" class="section">
        <h1>Happy Birthday & Happy 11 Months!</h1>
        
        <div class="outro-container">
            <p>I hope you liked this little website I made for you. I love you so much and happy birthday and 11th monthsary to us!</p>
        </div>
        
        <div class="blue-heart">üíô</div>
        
        <div class="nav-buttons">
            <button id="restart-btn" class="nav-btn">Start Over</button>
        </div>
    </section>

    <script>
        // Navigation between sections
        const sections = document.querySelectorAll('.section');
        let currentSection = 0;
        
        // Show specific section
        function showSection(index) {
            sections.forEach(section => section.classList.remove('active'));
            sections[index].classList.add('active');
            currentSection = index;
        }
        
        // Introduction section
        document.getElementById('yes-btn').addEventListener('click', () => {
            showSection(1); // Minigame section
            initMemoryGame();
        });
        
        document.getElementById('no-btn').addEventListener('click', () => {
            alert("Take your time, my love. But I really hope you'll say yes soon! ‚ù§Ô∏è");
        });
        
        // Minigame section
        function initMemoryGame() {
            const memoryGame = document.getElementById('memory-game');
            memoryGame.innerHTML = '';
            
            // Pairs for our 11 months together
            const cards = [
                '‚ù§Ô∏è', '‚ù§Ô∏è',
                'üåπ', 'üåπ',
                'üìÖ', 'üìÖ',
                'üéÇ', 'üéÇ',
                'üíô', 'üíô',
                'üéâ', 'üéâ',
                'ü•∞', 'ü•∞',
                'üòò', 'üòò',
                'ü§ó', 'ü§ó',
                'üíë', 'üíë',
                'üïØÔ∏è', 'üïØÔ∏è'
            ];
            
            // Shuffle cards
            cards.sort(() => Math.random() - 0.5);
            
            // Create cards
            cards.forEach((symbol, index) => {
                const card = document.createElement('div');
                card.classList.add('memory-card');
                card.dataset.symbol = symbol;
                card.dataset.index = index;
                
                card.innerHTML = `<span style="opacity: 0;">${symbol}</span>`;
                
                card.addEventListener('click', flipCard);
                memoryGame.appendChild(card);
            });
            
            // Game logic
            let hasFlippedCard = false;
            let lockBoard = false;
            let firstCard, secondCard;
            let matchedPairs = 0;
            
            function flipCard() {
                if (lockBoard) return;
                if (this === firstCard) return;
                
                this.classList.add('flipped');
                this.querySelector('span').style.opacity = '1';
                
                if (!hasFlippedCard) {
                    hasFlippedCard = true;
                    firstCard = this;
                    return;
                }
                
                secondCard = this;
                checkForMatch();
            }
            
            function checkForMatch() {
                const isMatch = firstCard.dataset.symbol === secondCard.dataset.symbol;
                
                if (isMatch) {
                    disableCards();
                    matchedPairs++;
                    
                    if (matchedPairs === cards.length / 2) {
                        document.getElementById('continue-btn').disabled = false;
                    }
                } else {
                    unflipCards();
                }
            }
            
            function disableCards() {
                firstCard.classList.add('matched');
                secondCard.classList.add('matched');
                firstCard.removeEventListener('click', flipCard);
                secondCard.removeEventListener('click', flipCard);
                resetBoard();
            }
            
            function unflipCards() {
                lockBoard = true;
                
                setTimeout(() => {
                    firstCard.classList.remove('flipped');
                    secondCard.classList.remove('flipped');
                    firstCard.querySelector('span').style.opacity = '0';
                    secondCard.querySelector('span').style.opacity = '0';
                    resetBoard();
                }, 1000);
            }
            
            function resetBoard() {
                [hasFlippedCard, lockBoard] = [false, false];
                [firstCard, secondCard] = [null, null];
            }
            
            // Continue button
            document.getElementById('continue-btn').addEventListener('click', () => {
                showSection(2); // Tulips section
                createTulips();
            });
        }
        
        // Tulips section - IMPROVED
        function createTulips() {
            const tulipField = document.querySelector('.tulip-field');
            
            // Clear any existing tulips
            const existingTulips = tulipField.querySelectorAll('.tulip');
            existingTulips.forEach(tulip => tulip.remove());
            
            // Create 17 tulips
            for (let i = 0; i < 17; i++) {
                const tulip = document.createElement('div');
                tulip.classList.add('tulip');
                
                // Position tulips evenly across the field
                const leftPos = (i * 5.5) + 5; // Evenly spaced
                
                // Random height variation
                const heightVariation = Math.random() * 20;
                const bottomPos = 40 + heightVariation;
                
                // Random sway delay and duration
                const swayDelay = Math.random() * 2;
                const swayDuration = 3 + Math.random() * 2;
                
                tulip.style.left = `${leftPos}%`;
                tulip.style.bottom = `${bottomPos}%`;
                tulip.style.animationDelay = `${swayDelay}s`;
                tulip.style.animationDuration = `${swayDuration}s`;
                
                tulip.innerHTML = `
                    <div class="tulip-stem"></div>
                    <div class="tulip-flower"></div>
                    <div class="tulip-leaf leaf-left"></div>
                    <div class="tulip-leaf leaf-right"></div>
                `;
                
                tulipField.appendChild(tulip);
            }
            
            // Next button
            document.getElementById('next-cake').addEventListener('click', () => {
                showSection(3); // Cake section
                initCake();
            });
        }
        
        // Cake section - IMPROVED
        function initCake() {
            const candleArea = document.getElementById('candle-area');
            const cakeCandles = document.getElementById('cake-candles');
            const cakeDecoration = document.getElementById('cake-decoration');
            
            // Clear any existing candles and decorations
            candleArea.innerHTML = '';
            cakeCandles.innerHTML = '';
            cakeDecoration.innerHTML = '';
            
            // Add cake decorations (chocolate spots)
            for (let i = 0; i < 15; i++) {
                const spot = document.createElement('div');
                spot.classList.add('cake-spot');
                spot.style.left = `${Math.random() * 90 + 5}%`;
                spot.style.top = `${Math.random() * 80 + 10}%`;
                cakeDecoration.appendChild(spot);
            }
            
            // Create 17 blue candles
            for (let i = 0; i < 17; i++) {
                const candle = document.createElement('div');
                candle.classList.add('candle');
                candle.draggable = true;
                candle.dataset.id = i;
                
                // Add flame (initially hidden)
                const flame = document.createElement('div');
                flame.classList.add('flame');
                flame.id = `flame-${i}`;
                candle.appendChild(flame);
                
                // Make draggable
                candle.addEventListener('dragstart', dragStart);
                
                candleArea.appendChild(candle);
            }
            
            // Make cake a drop target
            const cake = document.querySelector('.cake');
            cake.addEventListener('dragover', dragOver);
            cake.addEventListener('drop', dropCandle);
            
            // Variables for drag and drop
            let draggedCandle = null;
            let placedCandles = 0;
            
            function dragStart(e) {
                draggedCandle = this;
                e.dataTransfer.setData('text/plain', this.dataset.id);
            }
            
            function dragOver(e) {
                e.preventDefault();
            }
            
            function dropCandle(e) {
                e.preventDefault();
                if (!draggedCandle) return;
                
                // Remove from candle area
                draggedCandle.remove();
                
                // Add to cake - position in a line
                const candleClone = draggedCandle.cloneNode(true);
                candleClone.classList.add('placed');
                
                // Position candles in a straight line across the cake
                const position = (placedCandles * 20) + 10; // Evenly spaced
                candleClone.style.left = `${position}px`;
                
                // Make flame visible
                const flame = candleClone.querySelector('.flame');
                flame.classList.add('lit');
                
                cakeCandles.appendChild(candleClone);
                placedCandles++;
                
                // Check if all candles are placed
                const remainingCandles = candleArea.querySelectorAll('.candle').length;
                if (remainingCandles === 0) {
                    document.getElementById('mic-status').textContent = "All candles placed! Now click the microphone and blow!";
                }
                
                draggedCandle = null;
            }
            
            // Microphone functionality
            const microphone = document.getElementById('microphone');
            const micStatus = document.getElementById('mic-status');
            let isListening = false;
            
            microphone.addEventListener('click', toggleMicrophone);
            
            function toggleMicrophone() {
                if (placedCandles < 17) {
                    micStatus.textContent = "Please place all 17 candles first!";
                    return;
                }
                
                if (!isListening) {
                    // Start listening simulation
                    isListening = true;
                    microphone.classList.add('listening');
                    micStatus.textContent = "Listening... blow into your microphone now!";
                    
                    // Simulate blowing out candles after 3 seconds
                    setTimeout(() => {
                        blowOutCandles();
                    }, 3000);
                }
            }
            
            function blowOutCandles() {
                // Remove all flames
                const flames = document.querySelectorAll('.flame.lit');
                flames.forEach(flame => {
                    flame.style.opacity = '0';
                    flame.classList.remove('lit');
                });
                
                // Update UI
                microphone.classList.remove('listening');
                micStatus.innerHTML = "üéâ All candles blown out! Happy Birthday! üéâ";
                document.getElementById('next-letter').disabled = false;
                isListening = false;
            }
            
            // Next button
            document.getElementById('next-letter').addEventListener('click', () => {
                showSection(4); // Letter section
            });
        }
        
        // Letter section - IMPROVED
        document.getElementById('envelope').addEventListener('click', () => {
            const letterOverlay = document.getElementById('letter-overlay');
            letterOverlay.classList.add('active');
        });
        
        document.getElementById('close-letter').addEventListener('click', (e) => {
            e.stopPropagation();
            const letterOverlay = document.getElementById('letter-overlay');
            letterOverlay.classList.remove('active');
        });
        
        // Close letter when clicking outside
        document.getElementById('letter-overlay').addEventListener('click', (e) => {
            if (e.target === document.getElementById('letter-overlay')) {
                document.getElementById('letter-overlay').classList.remove('active');
            }
        });
        
        document.getElementById('next-outro').addEventListener('click', () => {
            showSection(5); // Outro section
        });
        
        // Outro section
        document.getElementById('restart-btn').addEventListener('click', () => {
            showSection(0); // Back to intro
        });
        
        // Initialize tulips when page loads (for when user goes back)
        window.addEventListener('DOMContentLoaded', () => {
            // Pre-create tulips for faster loading
            if (document.getElementById('tulips')) {
                createTulips();
            }
        });
    </script>
</body>
</html>
